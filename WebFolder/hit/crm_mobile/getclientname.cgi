<!--HIT_EXECUTE

C_LONGINT(mJSONObject;pInvoiceNo)C_TEXT(CustomerID;CustomerName;ProjectName)C_BLOB(Web_ResponseDataBLOB)SET BLOB SIZE(Web_ResponseDataBLOB;0)mJSONObject:=JSON New Object If (_HIT_AuthenticateSession ="Session-Authenticated-OK")pInvoiceNo:=Num(_HIT_WebApp_GetField ("inv_no"))QUERY([Invoices];[Invoices]inv_number=pInvoiceNo)If (Records in selection([Invoices])>0)If ([Invoices]invoice_status="Paid")JSON Set Text (mJSONObject;"paid";"Already paid")ElseRELATE ONE([Invoices]client_id)If (Records in selection([Companies])>0)CustomerID:=[Companies]uuidCustomerName:=[Companies]company_NameEnd ifQUERY([Projects];[Projects]proj_name=[Invoices]project_code)If (Records in selection([Projects])>0)ProjectName:=[Projects]proj_nameEnd ifJSON Set Text (mJSONObject;"CustomerID";CustomerID)JSON Set Text (mJSONObject;"CustomerName";CustomerName)JSON Set Text (mJSONObject;"ProjectName";ProjectName)End if Else JSON Set Text (mJSONObject;"error";"Invoice doest not Exists.")End ifElseJSON Set Text (mJSONObject;"error";"AUTH FAILED")End ifWeb_ResponseDataBLOB:=JSON Save As Blob (mJSONObject)JSON Release (mJSONObject)_HIT_HTTPD_SetHTTPHeader ("Content-Type";"application/json")_HIT_HTTPD_AppendResponse (->Web_ResponseDataBLOB)
-->